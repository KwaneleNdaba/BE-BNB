{"version":3,"sources":["../../src/services/category.service.ts"],"sourcesContent":["import { Service } from 'typedi';\nimport { Category } from '@interfaces/category.interface';\nimport { CategoryModel } from '@models/category.model';\nimport { CreateCategoryDto } from '@dtos/category.dto';\nimport { HttpException } from '@exceptions/HttpException';\n\n@Service()\nexport class CategoryService {\n  public async findAllCategories(): Promise<Category[]> {\n    const categories: Category[] = await CategoryModel.find();\n    return categories;\n  }\n\n  public async findCategoryById(categoryId: string): Promise<Category> {\n    const category: Category = await CategoryModel.findOne({ _id: categoryId });\n    if (!category) {\n      throw new HttpException(404, \"Category not found\");\n    }\n    return category;\n  }\n\n  public async createCategory(categoryData: CreateCategoryDto): Promise<Category> {\n    const existingCategory = await CategoryModel.findOne({ slug: categoryData.slug });\n    if (existingCategory) {\n      throw new HttpException(409, `Category with slug ${categoryData.slug} already exists`);\n    }\n\n    const createdCategory: Category = await CategoryModel.create(categoryData);\n    return createdCategory;\n  }\n\n  public async updateCategory(categoryId: string, categoryData: CreateCategoryDto): Promise<Category> {\n    const existingCategory = await CategoryModel.findOne({ slug: categoryData.slug });\n    if (existingCategory && existingCategory._id !== categoryId) {\n      throw new HttpException(409, `Category with slug ${categoryData.slug} already exists`);\n    }\n\n    const updatedCategory: Category = await CategoryModel.findByIdAndUpdate(categoryId, categoryData, { new: true });\n    if (!updatedCategory) {\n      throw new HttpException(404, \"Category not found\");\n    }\n\n    return updatedCategory;\n  }\n\n  public async deleteCategory(categoryId: string): Promise<Category> {\n    const deletedCategory: Category = await CategoryModel.findOneAndDelete({_id : categoryId});\n    if (!deletedCategory) {\n      throw new HttpException(404, \"Category not found\");\n    }\n    return deletedCategory;\n  }\n}\n"],"names":["CategoryService","findAllCategories","categories","CategoryModel","find","findCategoryById","categoryId","category","findOne","_id","HttpException","createCategory","categoryData","existingCategory","slug","createdCategory","create","updateCategory","updatedCategory","findByIdAndUpdate","new","deleteCategory","deletedCategory","findOneAndDelete"],"mappings":";;;;+BAOaA;;;eAAAA;;;wBAPW;+BAEM;+BAEA;;;;;;;AAGvB,IAAA,AAAMA,kBAAN,MAAMA;IACX,MAAaC,oBAAyC;QACpD,MAAMC,aAAyB,MAAMC,4BAAa,CAACC,IAAI;QACvD,OAAOF;IACT;IAEA,MAAaG,iBAAiBC,UAAkB,EAAqB;QACnE,MAAMC,WAAqB,MAAMJ,4BAAa,CAACK,OAAO,CAAC;YAAEC,KAAKH;QAAW;QACzE,IAAI,CAACC,UAAU;YACb,MAAM,IAAIG,4BAAa,CAAC,KAAK;QAC/B;QACA,OAAOH;IACT;IAEA,MAAaI,eAAeC,YAA+B,EAAqB;QAC9E,MAAMC,mBAAmB,MAAMV,4BAAa,CAACK,OAAO,CAAC;YAAEM,MAAMF,aAAaE,IAAI;QAAC;QAC/E,IAAID,kBAAkB;YACpB,MAAM,IAAIH,4BAAa,CAAC,KAAK,CAAC,mBAAmB,EAAEE,aAAaE,IAAI,CAAC,eAAe,CAAC;QACvF;QAEA,MAAMC,kBAA4B,MAAMZ,4BAAa,CAACa,MAAM,CAACJ;QAC7D,OAAOG;IACT;IAEA,MAAaE,eAAeX,UAAkB,EAAEM,YAA+B,EAAqB;QAClG,MAAMC,mBAAmB,MAAMV,4BAAa,CAACK,OAAO,CAAC;YAAEM,MAAMF,aAAaE,IAAI;QAAC;QAC/E,IAAID,oBAAoBA,iBAAiBJ,GAAG,KAAKH,YAAY;YAC3D,MAAM,IAAII,4BAAa,CAAC,KAAK,CAAC,mBAAmB,EAAEE,aAAaE,IAAI,CAAC,eAAe,CAAC;QACvF;QAEA,MAAMI,kBAA4B,MAAMf,4BAAa,CAACgB,iBAAiB,CAACb,YAAYM,cAAc;YAAEQ,KAAK;QAAK;QAC9G,IAAI,CAACF,iBAAiB;YACpB,MAAM,IAAIR,4BAAa,CAAC,KAAK;QAC/B;QAEA,OAAOQ;IACT;IAEA,MAAaG,eAAef,UAAkB,EAAqB;QACjE,MAAMgB,kBAA4B,MAAMnB,4BAAa,CAACoB,gBAAgB,CAAC;YAACd,KAAMH;QAAU;QACxF,IAAI,CAACgB,iBAAiB;YACpB,MAAM,IAAIZ,4BAAa,CAAC,KAAK;QAC/B;QACA,OAAOY;IACT;AACF"}